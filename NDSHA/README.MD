***In a nutshell :*** *I created this code to obtain engineering parameters from synthetic earthquake signals (i.e. time histories) produced by the MS technique as featured in the NDSHA methodology (Panza 2001, 2012). The code reads and processes a large dataset of earthquake signals, calculating the parameters using a set of functions and keeping track of the range of settings associated to the simulations. I included several plotting options to clearly visualize the data and results. The final output is a dataframe containing seismic parameters derived from simulations that can be compared to earthquake observation data in a companion project section.*


The section /portfolio/seismic_records provided a set of engineering eathquake parameters thanks to instrumental data associated to actual UK earthquakes and recorded at several seismic stations scattered across the UK. In this section, the work involved producing a dataset of synthetic earthquake signals (i.e. time histories) with the MS techniques for these UK earthquakes and recording stations connected to seismic observations. I hence generated time histories for stations operating on broadband (B-channel) and high broadband (H-channel), just as instrumental data were available on both these channels.

In generating the synthetic time histories, some specifics related to simulation settings had to be accounted for:
* the upper corner frequency : synthetic signals can and were generated only for a 10 Hz upper frequency, hence the frequency "Tree branch" only includes 10 Hz (and not 25 Hz or 35 Hz as in portfolio/seismic_records).
* the earthquake fault-rupture realisation : this can be seen as the beginning of an earthquake, when the accumulated stress is released from a nucleation point located randomly along the plane fault (Figure 1). From the nucleation point starts a wave - the rupture front - that triggers other weak points along the fault as it propagates away from the nucleation point.
* the directivity : the angle formed between the direction taken by the rupture front and the recording station location, for which three angle values - 0°, 90° and 180° - are of particular interest.

<img src="https://user-images.githubusercontent.com/126000617/226198042-78561d11-1299-441d-9300-1b79b45e23f7.png" alt="realisation type" width="900"/>


The randomness in fault-rupture realisation and the directivity angle both create variations in earthquake signal amplitudes and need to be accounted for. This is achieved by simulating, for each earthquake and each associated seismic monitoring station, 100 earthquake realisations for each of the three directivity angles. Finally, for a given recording station, time histories are generated separately for each horizontal component (East-West, North-South) and for each ground motion type (acceleration, velocity, displacement).


Upon simulation of signals covering all settings previously discussed, the folder and subfolders containing the time histories have the following organisation: directivity angle, earthquake name and monitoring channels and fault-rupture realisation index appear in subfolder names.     
The time history (*.plt) files contain no metadata, but file names (generated by MS algorithm) contain the rest of useful information such as crustal structure index, ground motion type, horizontal component and station index.


The folder organisation and file names helped with loading and managing the time histories as well as tracking seismic characteristics (earthquakes, stations...) and simulation settings associated to the signals.
A Tree Structure was then created to re-organize the files to reflect the folder organisation on the computer. Simulation settings (b) real and (c) directivity were tracked by incorporating them into the Tree structure implemented in portfolio/seismic_records, via the tree branches "directivity" and "real" which record the directivity angle and the realisation index respectively.
Earthquake name and station recording channels B-channel & H-channel are tracked. Since only one corner frequency is relevant for the simulations, no Tree branch "frequency" was inserted.
	
  
 
  
  
  
  
  

The steps are as follows : 
+ creating functions for later operations (Arias Intensity, spectral accelerations, dataframe and list re-organizing),
+ preparing the file architecture for subsequent reading, 
+ reading and processing dataframe, 
+ creating a Tree Structure for organizing the files, 
+ processing files to extract relevant earthquake parameters such as PGA, spectral acceleration values, Arias-intensity related parameters,
+ plotting parameters related to earthquake events.



An example dataset with earthquake signals corresponding to different events, recording channels and stations is provided at the following link:
https://drive.google.com/drive/folders/1jdH0llIJzKXL89UEYmAZGeMVjHX_uXgJ?usp=sharing

A Tree Structure was decided from the onset, owing to the fact that acceleration data for each earthquake simulation (*.plt files) do not contain any metadata such as earthquake realisation number, event, directivity or station ID. The signals were therefore created using a tree structure holding such info using the directory and sub-directory names (ex: bil000/quake_dudley_Bchan/real01/). Signals were then read into R and processed following the same tree pattern.
  In terms of tree structure and how it connects to simulation processes, for each earthquake event and corresponding recording stations, 99 realisations of earthquake fault rupture are simulated for each of the 3 directivity angles 0, 90 and 180 degrees. In this code, as an example, only 3 realisations (instead of 99) for each of directivity angle are considered, and earthquake signals correspond to 4 separate seismic events, each of which recorded on 3 different stations.

References: 
+ Panza, G.F., Romanelli, F. and Vaccari, F., 2001. Seismic wave propagation in laterally heterogeneous anelastic media: theory and applications to seismic zonation. In Advances in geophysics (Vol. 43, pp. 1-95). Elsevier.

+ Panza, G.F., La Mura, C., Peresan, A., Romanelli, F. and Vaccari, F., 2012. Seismic hazard scenarios as preventive tools for a disaster resilient society. In Advances in geophysics (Vol. 53, pp. 93-165). Elsevier.

> Geology distribution associated to the seismic monitoring stations

<img src="https://user-images.githubusercontent.com/61290423/211395831-d7d4aeed-bae8-4f52-8a7b-dfe53c04a143.png" alt="geo distr" width="600"/>

> PGA Amplitude distribution associated to the seismic wavefront directivity angle in case of the Swansea earthquake

<img src="https://user-images.githubusercontent.com/61290423/211396042-991788bc-cfcd-451a-ab35-22b58d07fc4e.png" alt="PGA amp distr" width="750"/>

> Map of earthquakes and associated monitoring stations

<img src="https://user-images.githubusercontent.com/61290423/211563354-b06ce175-33f4-4b98-9f8a-5b616f313949.png" alt="map quakes station" width="650"/>

